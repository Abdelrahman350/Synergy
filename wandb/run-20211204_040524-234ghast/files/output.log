
2021-12-04 04:05:26.671884: I tensorflow/stream_executor/cuda/cuda_dnn.cc:366] Loaded cuDNN version 8100
2021-12-04 04:05:27.416119: I tensorflow/stream_executor/cuda/cuda_blas.cc:1774] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1/100:






















































































































































































































































































1633/1633 [==============================] - 569s 348ms/step - train_loss: 103.6037




























279/279 [==============================] - 58s 207ms/step - valid_loss: 101.9716 - train_loss: 103.6038 - val_loss: 101.9716
The validation loss improved from inf to 101.97164916992188.                 Saving model Model.h5
Epoch 2/100:




  27/1633 [..............................] - ETA: 9:24 - train_loss: 98.8354
Traceback (most recent call last):
  File "train.py", line 40, in <module>
    train(model, training_data_generator, validation_data_generator, 100,\
  File "/media/avidbeam/workspace/Abdelrahman_Workspace/Project_Codes/Synergy/utils/custom_fit.py", line 30, in train
    train_loss = train_batch(X_batch,\
  File "/media/avidbeam/workspace/Abdelrahman_Workspace/Project_Codes/Synergy/utils/custom_fit.py", line 64, in train_batch
    y_pred = model(X, training=True)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
    return fn(*args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/engine/base_layer.py", line 1083, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
    return fn(*args, **kwargs)
  File "/media/avidbeam/workspace/Abdelrahman_Workspace/Project_Codes/Synergy/model/synergy.py", line 56, in call
    X = self.mobileNet(batch_images)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
    return fn(*args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/engine/base_layer.py", line 1083, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
    return fn(*args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/engine/functional.py", line 451, in call
    return self._run_internal_graph(
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/engine/functional.py", line 589, in _run_internal_graph
    outputs = node.layer(*args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/utils/traceback_utils.py", line 64, in error_handler
    return fn(*args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/engine/base_layer.py", line 1083, in __call__
    outputs = call_fn(inputs, *args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/utils/traceback_utils.py", line 92, in error_handler
    return fn(*args, **kwargs)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/layers/normalization/batch_normalization.py", line 767, in call
    outputs = self._fused_batch_norm(inputs, training=training)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/layers/normalization/batch_normalization.py", line 654, in _fused_batch_norm
    self.add_update(variance_update)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/engine/base_layer.py", line 1776, in add_update
    update()  # pylint: disable=not-callable
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/layers/normalization/batch_normalization.py", line 648, in variance_update
    return self._assign_new_value(self.moving_variance, variance)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/keras/layers/normalization/batch_normalization.py", line 539, in _assign_new_value
    return variable.assign(value, name=scope)
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/tensorflow/python/ops/resource_variable_ops.py", line 906, in assign
    if not self._shape.is_compatible_with(value_tensor.shape):
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/tensorflow/python/framework/ops.py", line 1253, in shape
    self._tensor_shape = tensor_shape.TensorShape(self._shape_tuple())
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/tensorflow/python/framework/tensor_shape.py", line 775, in __init__
    self._dims = [Dimension(d) for d in dims]
  File "/home/avidbeam/.virtualenvs/TensorFlow_2/lib/python3.8/site-packages/tensorflow/python/framework/tensor_shape.py", line 775, in <listcomp>
    self._dims = [Dimension(d) for d in dims]
KeyboardInterrupt